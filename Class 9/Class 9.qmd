---
title: "Class 9: Structural Bioinformatics (pt 1)"
author: "Michael Romero (A18135877)"
format: html
toc: true
---

## The PDB database


The main data base for structural biology is called the PDB. Lets have a look at what it contains:

Download a CSV file from the PDB site (accessible from **“Analyze” \> “PDB Statistics” \> “by Experimental Method and Molecular Type”)**. Move this CSV file into your RStudio project and use it to answer the following questions:

```{r}
stats <- read.csv("Data Export Summary.csv", row.names = 1)
head(stats)
```

>**Q1:** What percentage of structures in the PDB are solved by X-Ray and Electron Microscopy. Give your answer in 2 s.f.

```{r}
stats$Total
```

Oh, these are characters not numeric...

```{r}
sum( stats$Neutron)
SumTotal <- as.numeric(sub(",", "", stats$Total))
```
Long coding, inefficient

```{r pdbstats, message = FALSE}
library("readr")
stats <- read_csv("Data Export Summary.csv")
stats
```

```{r}
n.total <- sum(stats$Total)
```

```{r}
stats$`X-ray`
```

```{r}
n.xray <- sum(stats$`X-ray`)
percent.xray <- n.xray / n.total * 100
percent.xray
```
There are `r round(percent.xray, 2)` percent Xray structures in the PDB

>Q2: What proportion of structures in the PDB are protein?

```{r}
(209886 + 13718 + 15222)/ (209886 + 13718 + 15222 +4840 + 222 + 22)
```
97.9%


>Q3: Type HIV in the PDB website search box on the home page and determine how many HIV-1 protease structures are in the current PDB?

2406

## Exploring PDB structures

Package for structural bioinformatics
```{r}
library(bio3d)

hiv <- read.pdb("1hsg")
hiv
```

Let's first use the Mol* viewer to explore this structure. 

![My first view of HIV-Pr](1HSG.png)


![My first view of HIV-Pr](1HSG2.png)




## PDB objects in R

```{r}
head( hiv$atom )
```

Extract the sequence
```{r}
pdbseq(hiv)
```

```{r}
chainA_seq <- pdbseq( trim.pdb(hiv, chain = "A") )
```

I can interactively view these PDB objects in R iwth the new **bio3dview** package. This is not yet on CRAN. 

```{r}
install.packages("pak")
pak::pak("bioboot/bio3dview")
install.packages("NGLVieweR")
```


```{r}
library(bio3dview)


sel <- atom.select(hiv, resno=25)


view.pdb(hiv, highlight = sel, 
         highlight.style = "spacefill", 
         colorScheme = "chain",
         col = c("blue", "orange"), 
         backgroundColor = "pink")
```


## Predict protein flexibility

We can run a bioinformatics calculation to predict protein dynamics - i.e. functional motions.

We will use the `nma()` function:
```{r}
adk <- read.pdb("6s36")
adk
```

```{r}
m <- nma(adk)
  
plot(m)
```

Generate a "trajectory" of predicted motion.
```{r}
mktrj(m, file="ADK_nma.pdb")
```




